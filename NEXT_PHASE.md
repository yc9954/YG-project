# 다음 단계 구현 가이드

## ✅ 현재 완료된 기능

1. ✅ 오디오 분석 (librosa)
2. ✅ 모션 생성 (프롬프트별 차별화)
3. ✅ 3D 뷰어에 모션 표시
4. ✅ 오디오 재생 및 동기화
5. ✅ 타임라인 기본 기능

---

## 🎯 다음 단계 (우선순위 순)

### 1. 모션 데이터 형식 최적화 (중요, 1-2시간)

**문제**: 현재 모션 데이터가 3D 뷰어에 완벽하게 표시되지 않을 수 있음

**구현 내용**:
- 모션 데이터 구조 확인 및 디버깅
- 관절 매핑 개선 (22개 관절 → 스켈레톤 구조)
- 스케일 및 오프셋 조정
- 부드러운 보간 추가

**파일**: `Sota_KPop_Studio.jsx`의 `applyMotionFrame` 함수

---

### 2. 비트 동기화 강화 (중요, 2-3시간)

**목표**: 오디오 비트에 맞춰 모션을 정확히 동기화

**구현 내용**:
- 비트 타임스탬프에 맞춰 모션 키프레임 조정
- 비트에 맞춘 모션 강조 (에너지 증가)
- 비트 시각화 (타임라인에 비트 마커 표시)

**파일**: 
- `backend/services/motion_generator.py`의 `_align_to_beats` 함수
- `Sota_KPop_Studio.jsx`의 타임라인 컴포넌트

---

### 3. 타임라인 편집 기능 (중요, 2-3시간)

**목표**: 타임라인에서 모션 세그먼트를 자유롭게 편집

**구현 내용**:
- 세그먼트 복사/붙여넣기
- 여러 모션 세그먼트 조합
- 세그먼트 간 전환 효과
- 세그먼트 삭제 기능

**파일**: `Sota_KPop_Studio.jsx`의 `TimelineTrack` 컴포넌트

---

### 4. 모션 내보내기 개선 (중요, 3-4시간)

**목표**: 생성된 안무를 다양한 형식으로 내보내기

**구현 내용**:
- FBX 내보내기 (백엔드 연동)
- BVH 내보내기
- 비디오 렌더링 (선택사항)

**파일**: 
- `backend/main.py`에 내보내기 엔드포인트 추가
- `Sota_KPop_Studio.jsx`의 `handleExportFBX` 함수

---

### 5. 스타일 파인튜닝 준비 (장기, 1-2주)

**목표**: K-pop 안무에 특화된 모델 학습

**구현 내용**:
- K-pop 안무 영상 수집
- 포즈 추정 파이프라인
- 데이터 전처리 및 정규화
- 모델 파인튜닝

---

## 🚀 즉시 시작할 수 있는 작업

### 작업 1: 모션 데이터 형식 최적화 (1-2시간)

**목표**: 3D 뷰어에서 모션이 더 자연스럽게 표시되도록 개선

**단계**:
1. 콘솔에서 모션 데이터 구조 확인
2. 관절 매핑 수정
3. 스케일 조정
4. 테스트

### 작업 2: 비트 시각화 (1시간)

**목표**: 타임라인에 비트 마커 표시

**단계**:
1. 타임라인에 비트 마커 추가
2. 비트 클릭 시 해당 위치로 이동
3. 비트에 맞춰 모션 강조

### 작업 3: 세그먼트 편집 기능 (2-3시간)

**목표**: 타임라인에서 모션 세그먼트 편집

**단계**:
1. 세그먼트 복사 기능
2. 세그먼트 붙여넣기 기능
3. 세그먼트 삭제 기능
4. 여러 세그먼트 조합

---

## 💡 추천 순서

1. **모션 데이터 형식 최적화** (가장 중요)
   - 사용자가 바로 확인할 수 있는 개선
   - 3D 뷰어에서 모션이 더 자연스럽게 보임

2. **비트 시각화** (사용자 경험 개선)
   - 타임라인에 비트 표시
   - 비트 클릭으로 정확한 위치 이동

3. **타임라인 편집 기능** (편의성)
   - 세그먼트 복사/삭제
   - 여러 모션 조합

4. **모션 내보내기** (완성도)
   - FBX/BVH 내보내기
   - 실제 사용 가능한 형식

---

## 📝 체크리스트

### 즉시 개선 가능
- [ ] 모션 데이터 형식 최적화
- [ ] 관절 매핑 개선
- [ ] 스케일 조정

### 사용자 경험 개선
- [ ] 비트 시각화
- [ ] 타임라인 편집 기능
- [ ] 세그먼트 복사/삭제

### 완성도 향상
- [ ] 모션 내보내기 (FBX/BVH)
- [ ] 비디오 렌더링
- [ ] 성능 최적화

---

## 🔧 기술적 세부사항

### 모션 데이터 구조
```javascript
{
  frames: 300,
  joints: 22,
  data: [
    // 프레임 0
    [[x, y, z], [x, y, z], ...], // 관절별 좌표
    // 프레임 1
    [[x, y, z], [x, y, z], ...],
    ...
  ],
  fps: 30
}
```

### 관절 매핑
- 0: Hips (엉덩이)
- 1-4: Spine (척추)
- 5-8: Arms (팔)
- 9-12: Legs (다리)
- 15-16: Head (머리)

---

## 💬 다음 작업 선택

어떤 작업부터 시작할까요?

1. **모션 데이터 형식 최적화** - 3D 뷰어 개선
2. **비트 시각화** - 타임라인에 비트 표시
3. **타임라인 편집** - 세그먼트 복사/삭제
4. **모션 내보내기** - FBX/BVH 내보내기

원하는 작업을 알려주시면 바로 구현하겠습니다!

